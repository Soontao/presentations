<!DOCTYPE html>
<html>

<head>
  <title>Presentation List</title>
  <script id="sap-ui-bootstrap" src="https://openui5.hana.ondemand.com/resources/sap-ui-core.js"
    data-sap-ui-theme="sap_fiori_3" data-sap-ui-libs="sap.m" data-sap-ui-resourceroots='{"index": "./"}'
    data-sap-ui-async="true" displayBlock="true" data-sap-ui-xx-waitfortheme="true">
    </script>
</head>

<body class="sapUiBody" id="content">
</body>

<script>
  sap.ui.getCore().attachInit(function () {
    const model = new sap.ui.model.json.JSONModel([])
    const list = new sap.m.SelectList({
      items: {
        path: "/",
        template: new sap.ui.core.ListItem({
          text: "{title}"
        })
      },
      itemPress: event => {
        const presentationPath = event.getParameter("item").getBindingContext().getObject("path")
        window.open(presentationPath)
      }
    })

    model.loadData("./presentations.json")

    list.setModel(model)

    const app = new sap.m.App({
      pages: new sap.m.Page({
        content: [list],
        customHeader: new sap.m.Bar({
          contentLeft: sap.m.Title({ text: "Theo's Presentation List" }),
          contentRight: sap.m.Button({
            icon: "sap-icon://source-code",
            text: "Source Code",
            press: () => {
              window.open("https://github.com/Soontao/presentations", "_blank").focus()
            }
          })
        })
      })
    })

    const shell = new sap.m.Shell({
      app
    })

    shell.placeAt("content")
  });
</script>

</html>